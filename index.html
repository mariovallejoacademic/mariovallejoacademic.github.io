<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Mario Vallejo — Portfolio</title>
<style>
  :root{--bg:#0b0b0c;--text:#ececec;--muted:#a7a7a7;--card:#151518;--accent:#5cc8ff;--maxw:1280px;--r:14px}
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  a{color:var(--accent);text-decoration:none}
  a:hover{text-decoration:underline}
  .container{max-width:var(--maxw);margin:0 auto;padding:0 16px}
  header{position:sticky;top:0;border-bottom:1px solid #26262a;background:rgba(11,11,12,.7);backdrop-filter:blur(6px);z-index:10}
  header .bar{display:flex;align-items:center;justify-content:space-between;height:64px}
  .brand{font-weight:700;color:var(--text)}
  nav ul{display:flex;gap:10px;list-style:none;margin:0;padding:0}
  nav a{padding:8px 12px;border-radius:999px}
  nav a[aria-current="page"]{background:var(--card)}
  main{padding:28px 0}
  h1{margin:.2em 0 .4em}
  .muted{color:var(--muted)}
  .button{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--accent);color:#000;font-weight:600}
  .cards{list-style:none;display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));padding:0;margin:16px 0}
  .card{background:var(--card);border:1px solid #26262a;border-radius:var(--r);padding:16px}
  footer{border-top:1px solid #26262a;margin-top:40px}
  footer .container{height:64px;display:flex;align-items:center;justify-content:center;color:var(--muted);font-size:14px}
  section{display:none}
  section.active{display:block}

  /* Subnav for portfolio categories (shows only on Portfolio) */
  .subnav{display:none;border-top:1px solid #26262a;background:rgba(11,11,12,.7);backdrop-filter:blur(6px)}
  .subnav .container{display:flex;gap:8px;height:48px;align-items:center}
  .subnav a{padding:8px 12px;border-radius:999px}
  .subnav a[aria-current="page"]{background:var(--card)}

  /* Filter chips */
  .filters{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 4px}
  .filter-btn{appearance:none;border:1px solid #2b2b30;background:var(--card);color:var(--text);padding:8px 12px;border-radius:999px;font-weight:600;cursor:pointer}
  .filter-btn:hover{border-color:#3a3a40}
  .filter-btn[aria-pressed="true"]{background:var(--accent);color:#000;border-color:transparent}
  
  /* ===== HOME HERO BACKGROUND ===== */
  #home.hero{
    position: relative;
    border:1px solid #26262a;
    border-radius: var(--r);
    padding: 32px 16px 16px;
    min-height: 60vh;
    background:
      linear-gradient(180deg, rgba(11,11,12,.55), rgba(11,11,12,.55)),
      var(--hero-img, url('assets/hero.jpg')) center/cover no-repeat;
  }
  @media (min-width: 900px){
    #home.hero{padding: 56px 24px 24px; min-height: 80vh}
  }

  /* ===== ABOUT ===== */
  #about .about-grid{display:grid;gap:16px;align-items:start}
  @media (min-width:820px){
    #about .about-grid{grid-template-columns: 1fr 1.00fr;}
    #about .about-photo-wrap{align-self: stretch;}
    #about .about-photo{height: 100%; object-fit: cover;}
  }
  #about .about-photo{width:100%;height:auto;display:block;border-radius:var(--r);border:1px solid #26262a;object-fit:cover}

  /* ===== HOME HERO CENTER ===== */
  #home .hero-center{
    min-height: inherit;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    flex-direction: column;
    gap: 8px;
    margin: 0 auto;
    max-width: var(--maxw);
    padding: 0 16px;
  }
  #home .site-title{ margin: 0; font-size: clamp(28px, 5vw, 56px); line-height: 1.1; }
  #home .site-subtitle{ margin: 4px 0 0; color: var(--muted); font-weight: 600; letter-spacing: .01em; }
  #home .hero-box{
    display: inline-block;
    padding: 16px 20px;
    border: 1px solid rgba(236,236,236,.75);
    border-radius: var(--r);
    background: rgba(11,11,12,.68);
    backdrop-filter: blur(6px);
    box-shadow: 0 6px 28px rgba(0,0,0,.35);
    max-width: 90vw;
  }

  /* ===== Posts helpers ===== */
  #post-abbey-road .media-3{
    display: grid; gap: 14px; grid-template-columns: 1fr; margin: 16px 0 8px;
  }
  #post-abbey-road img{
    width: 100%; height: auto; display: block; border-radius: var(--r);
    border: 1px solid #26262a; object-fit: cover;
  }
  @media (min-width: 900px){
    #post-abbey-road .media-3{ grid-template-columns: repeat(3, 1fr); }
  }
  #post-abbey-road figure{margin:0}
  #post-abbey-road figcaption{ margin-top:6px; font-size:14px; line-height:1.4; color:var(--muted); }

  /* Two-column post gallery */
  #post-abbey-road .media-split{display:grid;gap:14px;grid-template-columns:1fr}
  #post-abbey-road .media-split figure{margin:0}
  @media (min-width:900px){
    #post-abbey-road .media-split{grid-template-columns:1fr 1fr;align-items:stretch}
    #post-abbey-road .media-split .tall{height:100%}
    #post-abbey-road .media-split .tall img{width:100%;height:100%;object-fit:cover}
    #post-abbey-road .media-split .stack{display:grid;grid-template-rows:1fr 1fr;gap:14px}
    #post-abbey-road .media-split .stack figure{height:100%}
    #post-abbey-road .media-split .stack img{width:100%;height:100%;object-fit:cover}
  }
  @media (min-width:900px){
    #post-abbey-road .media-split .stack figure{
      display:flex; flex-direction:column; min-height:0;
    }
    #post-abbey-road .media-split .stack img{
      flex:1 1 auto; width:100%; height:auto; min-height:0; object-fit:cover;
    }
  }

  /* ===== AES post layout ===== */
  #post-aes-warsaw-2025 .media-split{display:grid;gap:14px;grid-template-columns:1fr}
  #post-aes-warsaw-2025 .media-split figure{margin:0}
  #post-aes-warsaw-2025 img{
    width:100%;height:auto;display:block;border-radius:var(--r);
    border:1px solid #26262a;object-fit:cover;
  }
  #post-aes-warsaw-2025 figcaption{
    margin-top:6px;font-size:14px;line-height:1.4;color:var(--muted);
  }
  @media (min-width:900px){
    #post-aes-warsaw-2025 .media-split{grid-template-columns:1fr 1fr;align-items:stretch}
    #post-aes-warsaw-2025 .media-split .tall{height:100%}
    #post-aes-warsaw-2025 .media-split .tall img{width:100%;height:100%;object-fit:cover}
    #post-aes-warsaw-2025 .media-split .stack{
      display:grid;grid-template-rows:1fr 1fr;gap:14px
    }
    #post-aes-warsaw-2025 .media-split .stack figure{height:100%}
    #post-aes-warsaw-2025 .media-split .stack img{width:100%;height:100%;object-fit:cover}
  }
  @media (min-width:900px){
    #post-aes-warsaw-2025 .media-split .stack figure{ display:flex;flex-direction:column;min-height:0; }
    #post-aes-warsaw-2025 .media-split .stack img{ flex:1 1 auto;width:100%;height:auto;min-height:0;object-fit:cover; }
  }

  /* ===== Estúpido (Dolby Atmos) ===== */
  #post-estupido-atmos figure{margin:0}
  #post-estupido-atmos video{
    width:100%; height:auto; display:block; border-radius:var(--r);
    border:1px solid #26262a; object-fit:cover;
  }
  #post-estupido-atmos figcaption{ margin-top:6px;font-size:14px;line-height:1.4;color:var(--muted); }

  /* ——— MEDIA UNIFICADA EN POSTS (ÚNICO) ——— */
  section[id^="post-"] figure{
    max-width: 860px !important;
    margin: 16px auto !important;
  }
  section[id^="post-"] img,
  section[id^="post-"] video{
    width: 100% !important;
    height: auto !important;
    display: block !important;
    border-radius: var(--r) !important;
    border: 1px solid #26262a !important;
    object-fit: cover !important;
  }
  /* YouTube: contenedor con aspect-ratio y mismo ancho que imágenes */
  section[id^="post-"] .yt-figure{
    max-width: 860px !important;
    margin: 16px auto !important;
    border-radius: var(--r) !important;
    border: 1px solid #26262a !important;
    overflow: hidden !important;
    aspect-ratio: 16/9 !important;
  }
  section[id^="post-"] .yt-figure iframe{
    width: 100% !important;
    height: 100% !important;
    display: block !important;
    border: 0 !important;
  }
</style>

<header>
  <div class="container bar">
    <a href="#home" class="brand">Mario A. Vallejo Reyes / Academic Website</a>
    <nav aria-label="Main">
      <ul>
        <li><a href="#home" data-nav="home">Home</a></li>
        <li><a href="#about" data-nav="about">About me</a></li>
        <li><a href="#portfolio" data-nav="portfolio">Portfolio</a></li>
      </ul>
    </nav>
  </div>
  <nav id="subnav" class="subnav" aria-label="Portfolio categories">
    <div class="container" id="subnavInner"></div>
  </nav>
</header>

<main class="container">
  <section id="home" class="active hero">
    <div class="hero-center">
      <div class="hero-box">
        <h1 class="site-title">mariovallejoacademic.github.io</h1>
        <p class="site-subtitle">A WEBSITE TO SHOWCASE MY LATEST WORK IN AUDIO AND MUSIC TECHNOLOGY.</p>
      </div>
    </div>
  </section>

  <section id="about">
    <h1>About me</h1>
    <div class="about-grid">
      <div class="about-copy">
        <p>I am Mario Alberto Vallejo Reyes, a Research Assistant in the Audio Lab at the University of York (UK). I design controlled listening tests, manage data collection and analysis, develop audio signal-processing workflows, and co-author peer-reviewed publications.</p>
        <p>I hold an MSc in Audio and Music Technology (University of York), an MSc in Educational Technology (Universidad Da Vinci), and a BSc in Audio Engineering (SAE Institute Mexico). My research investigates psychoacoustic phenomena—recent work includes a validation study of soft-clipping effects (AES Latin American Convention 2024) and a MIDI-based analysis of Mexican folk vocal melodies (arXiv:2503.24243).</p>
        <p>Over the past decade I have engineered recordings in professional studios, contributed to a Latin Grammy–nominated project, and mixed Dolby Atmos tracks featured on Apple Music. My credits appear on productions with almost two billion streams, and my VR-based interactive music system represented York at Game Republic 2024. I am Avid-certified in Pro Tools (levels 101 and 110), hold a Producer Certificate in Ableton Live, and am Waves Audio certified.</p>
      </div>
      <figure class="about-photo-wrap">
        <img src="assets/about_me_v01.jpg" alt="Mario Vallejo" class="about-photo">
      </figure>
    </div>
  </section>

  <section id="portfolio">
    <h1>Portfolio</h1>
    <h2 data-cat="Research">Research</h2>
    <h2 data-cat="Coding">Coding</h2>
    <h2 data-cat="Distinctions">Distinctions</h2>
    <h2 data-cat="Interactive Systems">Interactive Systems</h2>
    <h2 data-cat="Production">Production</h2>
    <h2 data-cat="Teaching">Teaching</h2>
  </section>

  <!-- ===== POST: ABBEY ROAD TALK ===== -->
  <section id="post-abbey-road">
    <p><a href="#portfolio/Distinctions">← Back to Portfolio</a></p>
    <h1>Abbey Road Education Talk</h1>
    <p class="muted">Distinctions • Abbey Road Studios, Studio Three • London • August 22, 2025</p>
    <p>I was honoured to be invited to present at Abbey Road Studios during the Audiomovers Educators Advisory Group, a day that brought together audio educators worldwide. I shared a class case study we run at the University of York, led by Prof. Liam Maloney with me as teaching assistant: teaching analog mixing via on-site streaming.</p>
    <p>Traditional approaches to teaching analog mixing often require splitting large classes into multiple small sessions, which can lead to repeated deliveries, teacher fatigue, limited visibility around the console, and constant interruptions that prevent the mixer from reaching “the zone.” As a result, students often miss the chance to experience an authentic, uninterrupted mixing process.</p>
    <p>How it works: the mix takes place on an analog console in a studio, while the students listen from a lecture theatre. High-quality audio is streamed, and video feeds from the DAW and cameras are switched at the console via a small MIDI controller. A moderator in the theatre handles Q&A independently, answering questions in the room while the mixer continues uninterrupted.</p>
    <p>Why this is useful: students observe a complete mix in context, ask questions in real time through the moderator without disrupting the session. The same class model also adapts to recording technique, production walkthroughs, and spatial-audio demonstrations.</p>
    <p>Many thanks to John Krivit for making this possible.</p>

    <div class="media-split">
      <figure class="tall">
        <img src="assets/abbey-road-door.jpg" alt="Outside the Abbey Road entrance">
        <figcaption>Arriving at Abbey Road before the morning sessions.</figcaption>
      </figure>
      <div class="stack">
        <figure>
          <img src="assets/abbey-road-talk-studio3.jpg" alt="Presenting the on-site streaming workflow in Studio Three">
          <figcaption>Explaining a University of York class model for teaching analog mixing via on-site streaming.</figcaption>
        </figure>
        <figure>
          <img src="assets/abbey-road-studio3-empty.jpg" alt="Educators in Studio Three control room exchanging ideas">
          <figcaption>Educators exchanging ideas on approaches to audio education.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- ===== POST: AES EUROPE 2025 JUDGE ===== -->
  <section id="post-aes-warsaw-2025">
    <p><a href="#portfolio/Distinctions">← Back to Portfolio</a></p>
    <h1>Judge at AES Europe 2025, Warsaw, Poland</h1>
    <p class="muted">Distinctions • AES Europe Convention • Warsaw, Poland • June 4, 2025</p>
    <p>I served as a judge for Category 4 (Sound for Video) in the student competition at the Audio Engineering Society (AES) Europe Convention 2025 in Warsaw, Poland. The competition brought in audiovisual submissions from students worldwide, evaluated in a professional 5.1 studio since several mixes were delivered in immersive formats.</p>
    <p>My assessments focused on mix quality, frequency balance, spatial design, dynamics control, synchronization, technical execution, and overall creative approach. Scoring and written evaluations were completed prior to the convention.</p>
    <p>During the event, I joined the judging panel for a public 5.1 playback of the four finalists, offering live feedback over microphone to both the audience and the finalists. I also took part in the award ceremony immediately after the session.</p>
    <p>This participation reflects my ongoing involvement in audio education, supporting environments where students share work and receive structured, standards-based critique.</p>

    <div class="media-split">
      <figure class="tall">
        <img src="assets/aes-warsaw-stage.jpg" alt="On stage before the session began, mic in hand">
        <figcaption>On stage before the session, ready for the 5.1 finalist playback and feedback.</figcaption>
      </figure>
      <div class="stack">
        <figure>
          <img src="assets/aes-warsaw-audience.jpg" alt="Audience and main screen during review of a finalist submission">
          <figcaption>Audience and main screen during review of a finalist submission; judges monitoring from the sweet spot.</figcaption>
        </figure>
        <figure>
          <img src="assets/aes-warsaw-closing.jpg" alt="Closing ceremony screen thanking the judges">
          <figcaption>Closing ceremony screen thanking the judges, with my name shown among the list.</figcaption>
        </figure>
      </div>
    </div>
  </section>

  <!-- ===== POST: Estúpido (Dolby Atmos) — Production ===== -->
  <section id="post-estupido-atmos" data-thumb="assets/estupido-poster.jpg">
    <p><a href="#portfolio/Production">← Back to Portfolio</a></p>
    <h1>Mixing “Estúpido” in Dolby Atmos — Apple Music Hip-Hop in Spatial Audio</h1>
    <p class="muted">Production • Apple Music — Hip-Hop in Spatial Audio</p>

    <p>I mixed “Estúpido” by Mexican hip-hop artist Adán Cruz in Dolby Atmos. The track was featured in Apple Music’s official
      <em>Hip-Hop in Spatial Audio</em> playlist — a curated selection that includes artists such as Feid, Bad Bunny, Future, Lil Baby, Jhayco, Gunna, and Offset.</p>

    <figure>
      <video controls preload="metadata" poster="assets/estupido-poster.jpg">
        <source src="assets/estupido-apple-music-v02.m4v" type="video/mp4">
        Your browser does not support HTML5 video.
      </video>
      <figcaption>Screen recording of Apple Music’s “Hip-Hop in Spatial Audio” playlist with “Estúpido” featured.</figcaption>
    </figure>

    <p>The mix involved adapting the original stereo session to an immersive format while maintaining vocal presence, low-end control,
      and overall clarity. I focused on spatial placement that adds dimension without compromising the directness of the performance,
      while ensuring a clean stereo fold-down.</p>

    <p>Being selected for a major editorial playlist highlights the level of technical precision expected in commercial Atmos releases.
      While my research centers on auditory perception and spatial audio, I remain active in production to stay aligned with current
      workflows and creative standards.</p>
  </section>

  <!-- ===== POST: ReaScript Automation & Batch Export (Coding) ===== -->
  <section id="post-reascript-batch-export" data-thumb="assets/reascript-thumb-v02.png">
    <img src="assets/reascript-thumb-v02.png" alt="" data-thumb style="display:none">
    <p><a href="#portfolio/Coding">← Back to Portfolio</a></p>
    <h1>ReaScript Automation & Batch Export Tool for REAPER</h1>
    <p class="muted">Coding • University of York AudioLab • 2025</p>

    <p>
      This custom ReaScript lets you automatically locate and control any plugin parameter in REAPER by name, define its value range,
      and export audio files with incremental parameter steps — all in one automated process.
    </p>

    <figure style="max-width:860px;margin:16px auto;">
      <video controls preload="metadata" poster="assets/reascript-thumb-v02.png"
        style="width:100%;height:auto;display:block;border-radius:var(--r);border:1px solid #26262a;object-fit:cover;">
        <source src="assets/reascript-demo.mp4" type="video/mp4">
        Your browser does not support HTML5 video.
      </video>
      <figcaption>Demonstration: the parameter is stepped automatically and audio files are batch-exported.</figcaption>
    </figure>

    <p>
      Originally developed for my research on reverberation perception, this tool generated large batches of audio stimuli with stepped
      reverb decay times and direct-to-reverberant ratios (DRRs). Scripting the process saved hours and ensured consistent, reproducible
      conditions across exports.
    </p>

    <p>
      The tool is included in the University of York AudioLab’s published resources, alongside utilities used in ongoing research.
      It consists of two scripts — one to locate plugin parameters by name (REAPER maps them internally by number), and another to set
      parameter ranges and handle batch export. A README with usage instructions and a demo video are included, making it useful beyond
      this specific study.
    </p>

    <figure style="max-width:860px;margin:16px auto;">
      <img src="assets/audiolab-resources.jpg" alt="Screenshot of the AudioLab published resources page listing the tool"
           style="width:100%;height:auto;display:block;border-radius:var(--r);border:1px solid #26262a;object-fit:cover;">
      <figcaption>AudioLab published resources page featuring the automation tool.</figcaption>
    </figure>

    <p>
      Use cases include music-perception studies, generating large audio datasets, or teaching — e.g., comparing perceptual effects of
      different plugin parameters.
    </p>
  </section>

  <section id="post-interactive-music-system" data-thumb="assets/ims-experience.avif">
    <p><a href="#portfolio/Interactive%20Systems">← Back to Portfolio</a></p>
    <h1>Interactive Music System — Debussy in Virtual Reality</h1>
    <p class="muted">Interactive Systems • Game Republic 2024 • Staffordshire University, UK</p>

    <h2>I. Introduction</h2>
    <p>
      I've developed a virtual reality application that offers a novel approach to experience music.
      This interactive music system reimagines the compositions of Claude Debussy through modern technologies.
    </p>

    <!-- Cap image via the figure wrapper -->
    <figure style="max-width:720px;margin:16px auto;">
      <img src="assets/ims-experience.avif" alt="Users at Game Republic 2024 enjoying the Interactive Music System"
           style="width:100%;height:auto;display:block;border-radius:var(--r);border:1px solid #26262a;object-fit:cover;">
      <figcaption>Users at Game Republic 2024 enjoying the experience of my Interactive Music System.</figcaption>
    </figure>

    <h2>II. Key Features</h2>
    <ul>
      <li><strong>Immersive Experience:</strong> Users explore a virtual museum environment, interacting with its elements.</li>
      <li><strong>Real-time Audio Interaction:</strong> The system responds to user movements within the virtual space, adjusting audio playback in real time.</li>
      <li><strong>Technical Integration:</strong> Unity for the 3D environment and VR interactions; Pro Tools and virtual analog synths for audio production and Debussy re-creations; MATLAB for impulse-response processing to simulate acoustic spaces.</li>
    </ul>

    <h2>III. Recognition</h2>
    <p>
      This project was showcased at Game Republic 2024, hosted by Staffordshire University in the United Kingdom.
      I was selected to represent the University of York at this event, alongside my classmate Daniel (who presented a separate application).
    </p>

    <!-- Cap image via the figure wrapper -->
    <figure style="max-width:720px;margin:16px auto;">
      <img src="assets/ims-group.avif" alt="At Game Republic 2024: Lecturer Michael, Mario, Daniel, and Lecturer Joe"
           style="width:100%;height:auto;display:block;border-radius:var(--r);border:1px solid #26262a;object-fit:cover;">
      <figcaption>At Game Republic 2024, Staffordshire University. L–R: Lecturer Michael, myself, fellow York student Daniel, and Lecturer Joe.</figcaption>
    </figure>

    <h2>IV. Available Resources</h2>
    <ul>
      <li><strong>Walkthrough Video:</strong> Demonstrates the Interactive Music System, showcasing user experience and key features. <a href="https://youtu.be/V2dwNi99Vd0?si=0o1vx8CFHukQVtPC" target="_blank">YouTube Link</a></li>
      <li><strong>Technical Report:</strong> In-depth report covering design and implementation (PDF). <a href="https://drive.google.com/file/d/19Px05wemOZvKAh6ryb8LQewnTRmBBZFP/view" target="_blank">Download Link</a></li>
      <li><strong>Try It Yourself:</strong> Playable application for Pico VR headsets (.apk). <a href="assets/ims_vr_build.apk" target="_blank">Download Link</a></li>
    </ul>
  </section>

  <!-- ===== POST: Music Production Impact and Selected Work ===== -->
  <section id="post-music-production-impact" data-thumb="assets/muso-rankings.avif">
    <p><a href="#portfolio/Production">← Back to Portfolio</a></p>
    <h1>Music Production Impact and Selected Work</h1>
    <p class="muted">Production • Selected Discography and Achievements</p>

    <h2>I. Professional Impact</h2>
    <p>
      Over the past decade, the songs I’ve mixed, mastered, or recorded have amassed 1.8 billion verified streams across Spotify, Apple Music, YouTube, and other major streaming platforms.
      Muso.ai ranks me in the top 2 % of each discipline:
    </p>
    <ul>
      <li>Mastering engineers</li>
      <li>Mixing engineers</li>
      <li>Recording engineers</li>
    </ul>

    <figure>
      <img src="assets/muso-rankings.avif"
           alt="Muso.ai rankings view highlighting Platinum and Gold track performance">
      <figcaption>1.8 billion streams across releases I’ve mixed, mastered, or recorded — placing my credits in Muso.ai’s top 1 %.</figcaption>
    </figure>

    <h2>II. Certified Releases</h2>
    <table style="width:100%;border-collapse:collapse;margin:16px 0;font-size:15px;">
      <thead>
        <tr style="border-bottom:1px solid #444;">
          <th style="text-align:left;padding:6px 4px;">Certification</th>
          <th style="text-align:left;padding:6px 4px;">Tracks</th>
          <th style="text-align:left;padding:6px 4px;">Approx. streams</th>
        </tr>
      </thead>
      <tbody>
        <tr><td style="padding:6px 4px;">4 × Platinum</td><td style="padding:6px 4px;">1</td><td style="padding:6px 4px;">~400 M</td></tr>
        <tr><td style="padding:6px 4px;">2 × Platinum</td><td style="padding:6px 4px;">2</td><td style="padding:6px 4px;">~500 M</td></tr>
        <tr><td style="padding:6px 4px;">3 × Gold</td><td style="padding:6px 4px;">2</td><td style="padding:6px 4px;">~30 M</td></tr>
        <tr><td style="padding:6px 4px;">Gold</td><td style="padding:6px 4px;">4</td><td style="padding:6px 4px;">~10 M</td></tr>
      </tbody>
    </table>

    <figure>
      <img src="assets/muso-credits.avif"
           alt="Muso.ai profile showing total streams and discipline rankings">
      <figcaption>My Platinum & Gold track certifications by stream count.</figcaption>
    </figure>

    <h2>III. Selected Works</h2>
    <p>
      The following two productions showcase different aspects of my work. One focuses on experimental engineering techniques, and the other on full creative and technical control from demo to final master. I update these periodically to reflect the range of my production experience.
    </p>

    <h3>Kódigos – Dinzagroove</h3>
    <figure class="yt-figure">
      <iframe src="https://www.youtube.com/embed/civnPYBfoEo?si=t5Ns54CQiBQ-tDwJ"
              title="Kódigos – Dinzagroove" allowfullscreen></iframe>
    </figure>
    <p>
      This experimental production features renowned Latin American touring musicians. The track breaks traditional structures with complex polyrhythms, unconventional scale choices, and a form centered around multiple solos. I served as recording engineer and editor, working with top-end gear (Avalon, Neve, Neumann, AKG), and used a section-specific quantization method to keep natural timing while improving precision.
    </p>

    <h3>Me Gustas – Reno Rojas ft. Monsieur Louf</h3>
    <figure class="yt-figure">
      <iframe src="https://www.youtube.com/embed/mVeKaGR9wlg?si=k2DBcgY2M1cFmAx_"
              title="Me Gustas – Reno Rojas ft. Monsieur Louf" allowfullscreen></iframe>
    </figure>
    <p>
      Starting from a simple ukulele and vocal demo, I handled co-composition, arrangement, vocal production, recording, mixing, and mastering. I brought in session musicians for acoustic guitar, electric guitar, and percussion. The final version has reached over 250 000 streams.
    </p>
  </section>
</main>

<footer>
  <div class="container"><small>© <span id="year"></span> Mario Vallejo</small></div>
</footer>

<!-- ===== JAVASCRIPT: ROUTING + CATEGORY FILTERS ===== -->
<script>
// ------- Routing (sections + portfolio subnav) -------
const CATS = ['All Work','Research','Coding','Distinctions','Interactive Systems','Production','Teaching'];
let subnavBuilt = false;

function show(raw){
  const input = raw || 'home';
  const [id, sub] = input.split('/');

  document.querySelectorAll('main section').forEach(s=>s.classList.remove('active'));
  (document.getElementById(id) || document.getElementById('home')).classList.add('active');

  document.querySelectorAll('nav[aria-label="Main"] a').forEach(a=>a.removeAttribute('aria-current'));
  const cur=document.querySelector('nav[aria-label="Main"] a[data-nav="'+id+'"]');
  if(cur) cur.setAttribute('aria-current','page');

  const subnav = document.getElementById('subnav');
  if(id==='portfolio'){
    initSubnav();
    subnav.style.display='block';
    const cat = decodeURIComponent(sub || 'All Work');
    applyFilter(cat);
  } else {
    subnav.style.display='none';
  }
}

addEventListener('hashchange',()=>{
  const hash = location.hash.slice(1);
  show(hash);
});

addEventListener('DOMContentLoaded',()=>{
  document.getElementById('year').textContent=new Date().getFullYear();
  const hash = location.hash.slice(1) || 'home';
  show(hash);
});

// ------- Subnav builder -------
function initSubnav(){
  if(subnavBuilt) return;
  const inner = document.getElementById('subnavInner');
  inner.innerHTML = '';
  CATS.forEach(cat=>{
    const a = document.createElement('a');
    a.href = '#portfolio' + (cat!=='All Work' ? '/' + encodeURIComponent(cat) : '');
    a.textContent = cat;
    a.dataset.cat = cat;
    inner.appendChild(a);
  });
  subnavBuilt = true;
}

// ------- Filtering -------
function applyFilter(cat){
  const choice = cat || 'All Work';

  const items = document.querySelectorAll('#portfolio li.card[data-cats]');
  items.forEach(li=>{
    const set = (li.dataset.cats||'').split(',').map(s=>s.trim());
    const show = choice === 'All Work' || set.includes(choice);
    li.style.display = show ? '' : 'none';
  });

  const headers = document.querySelectorAll('#portfolio h2[data-cat]');
  headers.forEach(h=>{
    h.style.display = (choice === 'All Work' || h.dataset.cat === choice) ? '' : 'none';
  });

  document.querySelectorAll('#portfolio ul.cards').forEach(ul=>{
    const hasVisible = Array.from(ul.querySelectorAll('li')).some(li => li.style.display !== 'none');
    ul.style.display = hasVisible ? 'grid' : 'none';
  });

  document.querySelectorAll('#subnavInner a').forEach(a=>{
    if(a.dataset.cat === choice){
      a.setAttribute('aria-current','page');
    } else {
      a.removeAttribute('aria-current');
    }
  });

  const newHash = '#portfolio' + (choice && choice!=='All Work' ? '/' + encodeURIComponent(choice) : '');
  if(location.hash !== newHash){
    history.replaceState(null,'',newHash);
  }
}
</script>

<script>
/* ===== Auto-generate portfolio cards from posts (big teaser + "Read more →") ===== */
(function(){
  let autoCardsBuilt = false;

  function currentPortfolioChoice(){
    const hash = location.hash.slice(1);
    if (!hash || !hash.startsWith('portfolio')) return null;
    const parts = hash.split('/');
    return decodeURIComponent(parts[1] || 'All Work');
  }

  function cardAlreadyExists(postId){
    return !!document.querySelector(`#portfolio a[href="#${postId}"]`);
  }

  function deriveCategory(post){
    const dc = (post.dataset.cats || '').trim();
    if (dc) return dc;
    const muted = post.querySelector('p.muted');
    if (muted){
      const first = muted.textContent.split('•')[0].trim();
      if (first) return first;
    }
    return '';
  }

  function ensureListFor(cat){
    const header = document.querySelector(`#portfolio h2[data-cat="${cat}"]`);
    if (!header) return null;
    let ul = header.nextElementSibling;
    if (!(ul && ul.matches('ul.cards'))){
      ul = document.createElement('ul');
      ul.className = 'cards';
      header.insertAdjacentElement('afterend', ul);
    }
    return ul;
  }

  function makeSnippet(post){
    const paras = Array.from(post.querySelectorAll('p')).filter(p=>{
      if (p.classList.contains('muted')) return false;
      if (p.querySelector('a[href^="#portfolio"]')) return false;
      const txt = p.textContent.trim();
      return txt.length > 0;
    });
    const text = paras.map(p=>p.textContent.trim()).join(' ').replace(/\s+/g,' ').trim();
    if (!text) return '';
    if (text.length <= 160) return text;
    return text.slice(0, 140).replace(/\s+\S*$/, '') + '…';
  }

  // >>> Thumbnail resolver (NO <script> anidados)
  function findThumbSrc(post){
    // 1) data-thumb en el <section>
    const explicit = post.getAttribute('data-thumb');
    if (explicit) return explicit;

    // 2) Cualquier hijo con data-thumb (img o video)
    const tagged = post.querySelector('[data-thumb]');
    if (tagged){
      if (tagged.tagName === 'VIDEO' && tagged.getAttribute('poster')) {
        return tagged.getAttribute('poster');
      }
      const s = tagged.getAttribute('src');
      if (s) return s;
    }

    // 3) Primera imagen normal
    const img = post.querySelector('img');
    if (img) return img.currentSrc || img.getAttribute('src') || '';

    // 4) Video con poster
    const vid = post.querySelector('video[poster]');
    if (vid) return vid.getAttribute('poster');

    // 5) Nada
    return '';
  }

  function buildAutoCards(){
    if (autoCardsBuilt) return;

    const posts = document.querySelectorAll('section[id^="post-"]');
    posts.forEach(post=>{
      const postId = post.id;
      if (cardAlreadyExists(postId)) return;

      const cat = deriveCategory(post);
      if (!cat) return;

      const ul = ensureListFor(cat);
      if (!ul) return;

      const title = (post.querySelector('h1')?.textContent || 'Untitled').trim();
      const imgSrc = findThumbSrc(post);
      const snippet = makeSnippet(post);

      const li = document.createElement('li');
      li.className = 'card';
      li.dataset.cats = cat;

      const a = document.createElement('a');
      a.href = `#${postId}`;
      a.style.display = 'block';
      a.style.color = 'inherit';
      a.style.textDecoration = 'none';

      const row = document.createElement('div');
      row.style.display = 'flex';
      row.style.gap = '12px';
      row.style.alignItems = 'flex-start';
      row.style.flexWrap = 'wrap';

      if (imgSrc){
        const thumb = document.createElement('div');
        thumb.style.flex = '0 1 440px';
        thumb.style.width = '440px';
        thumb.style.maxWidth = '100%';
        thumb.style.aspectRatio = '16 / 9';
        thumb.style.backgroundSize = 'cover';
        thumb.style.backgroundPosition = 'center';
        thumb.style.borderRadius = '8px';
        thumb.style.border = '1px solid #26262a';
        thumb.style.backgroundImage = `url('${imgSrc}')`;
        row.appendChild(thumb);
      }

      const col = document.createElement('div');
      col.style.minWidth = '0';
      col.style.flex = '1 1 260px';

      const h3 = document.createElement('h3');
      h3.style.margin = '0 0 6px 0';
      h3.textContent = title;

      const p1 = document.createElement('p');
      p1.style.display = '-webkit-box';
      p1.style.webkitLineClamp = '2';
      p1.style.webkitBoxOrient = 'vertical';
      p1.style.overflow = 'hidden';
      p1.textContent = snippet;

      const pCat = document.createElement('p');
      pCat.className = 'muted';
      pCat.style.margin = '2px 0 0 0';
      pCat.textContent = cat;

      const read = document.createElement('p');
      read.style.margin = '6px 0 0 0';
      read.style.fontWeight = '600';
      read.style.color = 'var(--accent)';
      read.textContent = 'Read more →';

      col.append(h3, pCat, p1, read);
      row.appendChild(col);
      a.appendChild(row);
      li.appendChild(a);
      ul.appendChild(li);
    });

    autoCardsBuilt = true;

    if (typeof applyFilter === 'function' && location.hash.startsWith('#portfolio')){
      const choice = currentPortfolioChoice() || 'All Work';
      applyFilter(choice);
    }
  }

  document.addEventListener('DOMContentLoaded', buildAutoCards);
  window.addEventListener('hashchange', function(){
    const h = location.hash.slice(1);
    if (h.startsWith('portfolio')) buildAutoCards();
  });
})();
</script>
